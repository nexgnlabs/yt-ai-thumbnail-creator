<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>India YouTube Trend Pulse (v3.0 - Resilient)</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        :root { --yt-red: #ff0000; --bg: #0a0a0a; --card: #151515; --text: #ffffff; --accent: #00d4ff; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); padding: 20px; }
        .container { max-width: 850px; margin: auto; background: var(--card); border-radius: 20px; padding: 30px; border: 1px solid #333; }
        #loader { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000; flex-direction: column; align-items: center; justify-content: center; }
        .bar-loader { width: 50px; height: 50px; border: 5px solid #222; border-top: 5px solid var(--accent); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .controls { display: flex; gap: 10px; margin-bottom: 25px; }
        select { flex: 2; padding: 12px; background: #000; color: #fff; border: 1px solid #444; border-radius: 8px; }
        .btn { flex: 1; background: var(--yt-red); color: #fff; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .trend-item { display: flex; align-items: center; padding: 15px; border-bottom: 1px solid #222; font-size: 14px; }
        .rank { width: 40px; color: var(--accent); font-weight: bold; }
        .topic { flex: 1; }
        .tag { font-size: 10px; background: #333; padding: 2px 6px; border-radius: 4px; margin-left: 8px; vertical-align: middle; }
    </style>
</head>
<body>

<div id="loader">
    <div class="bar-loader"></div>
    <p id="loader-status" style="margin-top: 20px;">Fetching India's Top Trends...</p>
</div>

<div class="container">
    <h2 style="text-align:center; margin-top:0;">India Viral Trend Hub</h2>
    <div class="controls">
        <select id="category">
            <option value="Trending Now">ğŸ”¥ Trending Now</option>
            <option value="Entertainment">ğŸ¬ Entertainment</option>
            <option value="Education">ğŸ“š Education</option>
            <option value="Gaming">ğŸ® Gaming</option>
            <option value="Film & Animation">ğŸ¥ Film & Animation</option>
            <option value="People & Blogs">ğŸ¤³ People & Blogs</option>
            <option value="Science & Technology">ğŸ§ª Science & Technology</option>
            <option value="Sports">ğŸ Sports</option>
            <option value="Music">ğŸµ Music</option>
            <option value="News & Politics">ğŸ“° News & Politics</option>
            <option value="How-to & Style">ğŸ’„ How-to & Style</option>
            <option value="Travel & Events">âœˆï¸ Travel & Events</option>
            <option value="Pets & Animals">ğŸ¾ Pets & Animals</option>
            <option value="Comedy">ğŸ˜‚ Comedy</option>
            <option value="Nonprofits & Activism">âœŠ Nonprofits & Activism</option>
        </select>
        <button class="btn" onclick="fetchTrends()">REFRESH TRENDS</button>
    </div>
    <div id="trendOutput"></div>
</div>

<script>
    async function fetchTrends() {
        const cat = document.getElementById('category').value;
        const loader = document.getElementById('loader');
        const output = document.getElementById('trendOutput');
        
        loader.style.display = 'flex';
        output.innerHTML = '';

        const prompt = `Find the TOP 10 trending one-liner YouTube topics for the category "${cat}" in India for December 2025. 
                        Include global megatrends if relevant to India. 
                        Format: Rank | Topic Title | Global (Yes/No)`;

        try {
            // PRIMARY ATTEMPT: Gemini 3 Pro
            let response;
            try {
                response = await puter.ai.chat(prompt, { model: 'gemini-3-pro-preview' });
            } catch (e) {
                console.warn("Gemini 3 Pro Busy, switching to Stable Fallback...");
                // FALLBACK: Gemini 2.5 Flash (More stable)
                response = await puter.ai.chat(prompt, { model: 'gemini-2.5-flash' });
            }

            const lines = response.toString().split('\n').filter(l => l.includes('|'));
            lines.forEach(line => {
                const [rank, title, global] = line.split('|');
                const item = document.createElement('div');
                item.className = 'trend-item';
                const globalTag = global && global.toLowerCase().includes('yes') ? '<span class="tag">GLOBAL</span>' : '';
                item.innerHTML = `<div class="rank">${rank}</div><div class="topic">${title}${globalTag}</div>`;
                output.appendChild(item);
            });

        } catch (error) {
            output.innerHTML = `<div style="color:#ff4444; text-align:center; padding:20px;">
                <b>Network Error:</b> The trend engine is temporarily overloaded. Please try again in 30 seconds.
            </div>`;
        } finally {
            loader.style.display = 'none';
        }
    }
</script>
</body>
</html>
